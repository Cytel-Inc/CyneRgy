---
title: "Multiple Arm, Analysis"
author: "Gabriel Potvin and Anoop Singh Rawat"
date: "`r format(Sys.time(), '%B %d, %Y')`"
---

<div class="alert alert-primary" role="alert">
<p style="margin-bottom:0">This example is related to the <a href="IntegrationPointAnalysis.html" class="alert-link">**Integration Point: Analysis**</a>. Click the link for setup instructions, variable details, and additional information about this integration point.</p></div>

<div class="alert alert-danger" role="alert">
To try this example, create a new project in East Horizon using the following configuration:
<ul style="margin-bottom:0">
<li>**Study objective:** Multiple Arm Confirmatory</li>
<li>**Number of endpoints:** Single Endpoint</li>
<li>**Endpoint type:**</li>
<ul style="margin-bottom:0">
<li>Continuous Outcome for Example 1</li>
<li>Time-to-Event Outcome for Example 2</li>
<li>Binary Outcome for Example 3</li>
</ul>
<li>**Task:** Any</li>
</ul></div>

<div class="alert alert-warning" role="alert">
<p style="margin-bottom:0">**Note:** This example is compatible with both Fixed Sample and Group Sequential statistical designs. The R code automatically detects whether interim look information (*LookInfo*) is available and adjusts the analysis parameters accordingly.</p>
</div>

# Introduction

The following examples illustrate how to integrate new **analysis** capabilities into East Horizon using R functions in the context of multi-arm clinical trials. Each example demonstrates a different type of statistical endpoint (continuous, time-to-event, and binary), using standard R functions and a Bonferroni adjustment to handle multiple comparisons.

In the [R directory of this example](https://github.com/Cytel-Inc/CyneRgy/tree/main/inst/Examples/MultiArmAnalysis/R) you will find the following R files:

1. [AnalyzeMultiArmUsingTTestBonferroni.R](https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingTTestBonferroni.R) - Performs pairwise t-tests for continuous endpoints with Bonferroni adjustment.

2. [AnalyzeMultiArmUsingLogrankTestBonferroni.R](https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingLogrankTestBonferroni.R) - Performs log-rank tests for time-to-event endpoints with Bonferroni adjustment.

3. [AnalyzeMultiArmUsingPropTestBonferroni.R](https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingPropTestBonferroni.R) - Performs proportion tests for binary endpoints with Bonferroni adjustment.


# Example 1 - Using the `t.test()` Function with Bonferroni Adjustment (Continuous Outcome)

<div class="alert alert-primary" role="alert">
  <p style="margin-bottom:0"> This example is related to this R file: <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingTTestBonferroni.R" class="alert-link">AnalyzeMultiArmUsingTTestBonferroni.R</a></p>
</div>

This example uses R's built-in `t.test()` function to compare continuous outcomes between each treatment arm and the control arm. The function computes individual p-values for each comparison, applies a Bonferroni adjustment to control the family-wise error rate, and then checks whether any adjusted p-values cross the efficacy boundaries defined by East Horizon.

At each interim or final analysis, only active arms are tested (based on `IsArmPresent`). The analysis is compatible with both fixed and group sequential designs.

The figure below illustrates where this example fits within the R integration points of Cytel products, accompanied by a flowchart outlining the general steps performed by the R code.

```{r echo=FALSE,  warning=FALSE, fig.retina=3}
CyneRgy::PlotExampleFlowchart(
    lIntPoints = list(
        "Analysis" = c(
            "Load responses from East Horizon",
            "Run t-test for each active treatment arm vs. control",
            "Apply Bonferroni correction to p-values",
            "Compare adjusted p-values to efficacy boundaries",
            "Return boundary-crossing decisions"
        )
    )
)
```

# Example 2 - Using the `survival::survdiff()` Function with Bonferroni Adjustment (Time-to-Event Outcome)

<div class="alert alert-primary" role="alert">
  <p style="margin-bottom:0"> This example is related to this R file: <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingLogrankTestBonferroni.R" class="alert-link">AnalyzeMultiArmUsingLogrankTestBonferroni.R</a></p>
</div>

For time-to-event outcomes, this example uses the `survival::survdiff()` function to perform a log-rank test between each treatment arm and the control arm. The chi-square statistic from each comparison is converted to a p-value, adjusted using Bonferroni correction, and evaluated against the efficacy boundary to determine if any treatment demonstrates a statistically significant improvement in survival.

This example can handle interim looks and automatically incorporates information fraction and efficacy boundary adjustments provided by `LookInfo`.

The figure below illustrates where this example fits within the R integration points of Cytel products, accompanied by a flowchart outlining the general steps performed by the R code.

```{r echo=FALSE,  warning=FALSE, fig.retina=3}
CyneRgy::PlotExampleFlowchart(
    lIntPoints = list(
        "Analysis" = c(
            "Load survival times from East Horizon",
            "Perform log-rank test (survdiff) for each treatment vs. control",
            "Adjust p-values using Bonferroni correction",
            "Compare adjusted p-values to efficacy boundaries",
            "Return arm-level decisions"
        )
    )
)
```

# Example 3 - Using the `prop.test()` Function with Bonferroni Adjustment (Binary Outcome)

<div class="alert alert-primary" role="alert">
  <p style="margin-bottom:0"> This example is related to this R file: <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/MultiArmAnalysis/R/AnalyzeMultiArmUsingPropTestBonferroni.R" class="alert-link">AnalyzeMultiArmUsingPropTestBonferroni.R</a></p>
</div>

This example analyzes binary outcomes using R's base `prop.test()` function. The test compares the proportion of responders in each treatment arm against the control arm, computes p-values for each test, and applies Bonferroni correction to account for multiple arms. Adjusted p-values are compared against efficacy boundaries to decide whether any arm demonstrates a statistically significant treatment effect.

The analysis dynamically accounts for dropped arms and adapts to both fixed and group sequential designs.

The figure below illustrates where this example fits within the R integration points of Cytel products, accompanied by a flowchart outlining the general steps performed by the R code.

```{r echo=FALSE,  warning=FALSE, fig.retina=3}
CyneRgy::PlotExampleFlowchart(
    lIntPoints = list(
        "Analysis" = c(
            "Load binary outcomes from East Horizon",
            "Run prop.test for each treatment vs. control",
            "Adjust p-values using Bonferroni correction",
            "Compare adjusted p-values to efficacy boundaries",
            "Return final decisions per treatment arm"
        )
    )
)
```
