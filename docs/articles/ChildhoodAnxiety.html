<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CyneRgy">
<title>Trial in Childhood Anxiety • CyneRgy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trial in Childhood Anxiety">
<meta property="og:description" content="CyneRgy">
<meta property="og:image" content="https://Cytel-Inc.github.io/CyneRgy/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CyneRgy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/ExampleOutline.html">Example List</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Patient Simulation</h6>
    <a class="dropdown-item" href="../articles/2ArmNormalOutcomePatientSimulationDescription.html">2-Arm, Normal Outcome</a>
    <a class="dropdown-item" href="../articles/2ArmTimeToEventOutcomePatientSimulationDescription.html">2-Arm, Time-to-Event Outcome</a>
    <a class="dropdown-item" href="../articles/2ArmBinaryOutcomePatientSimulation.html">2-Arm, Binary Outcome</a>
    <a class="dropdown-item" href="../articles/2ArmNormalRepeatedMeasuresResponseGeneration.html">2-Arm, Repeated Measure</a>
    <a class="dropdown-item" href="../articles/ChildhoodAnxiety.html">Childhood Anxiety Trial</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Analysis</h6>
    <a class="dropdown-item" href="../articles/2ArmNormalOutcomeAnalysisDescription.html">2-Arm, Normal Outcome</a>
    <a class="dropdown-item" href="../articles/2ArmTimeToEventOutcomeAnalysisDescription.html">2-Arm, Time-To-Event Outcome</a>
    <a class="dropdown-item" href="../articles/2ArmBinaryOutcomeAnalysisDescription.html">2-Arm, Binary</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Treatment Selection</h6>
    <a class="dropdown-item" href="../articles/TreatmentSelectionDescription.html">Binary Outcome</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced Examples</h6>
    <a class="dropdown-item" href="../articles/AssuranceConsecutiveStudies.html">Bayesian Assurance of Consecutive Studies</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other Integration Points</h6>
    <a class="dropdown-item" href="../articles/GeneratePoissonArrival.html">Poisson Arrival Times</a>
    <a class="dropdown-item" href="../articles/PatientDropout.html">Patient Dropout</a>
    <a class="dropdown-item" href="../articles/PatientRandomization.html">Patient Randomization</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">References</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ContibutingToCyneRgy.html">Contribute</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Cytel-Inc/CyneRgy">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trial in Childhood Anxiety</h1>
                        <h4 data-toc-skip class="author">Audrey Wathen,
J. Kyle Wathen</h4>
            
            <h4 data-toc-skip class="date">September 26, 2024</h4>
      
      
      <div class="d-none name"><code>ChildhoodAnxiety.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this example, we cover cover the situation where the patient data
simulation needs to be improved to match what is expected in a clinical
trial in childhood anxiety. The primary outcome in this clinical trial
is the change from baseline to follow-up of the Child Health Utility 9D
(CHU9D), which is a health-related quality of life measure that assesses
health status across nine dimensions for children with anxiety. This
example focuses on developing an approach to simulate the patient data
that is realistic and understanding the impact on the power or the the
study. Each item in the CHU9D is scored from 1 to 5 and the total of the
scores on the 9 elements is the CHU9D. The higher the total value the
lower the quality of life. Thus, the CHU9D ranges from 9 to 45 and this
the difference between baseline and follow-up must range between -36 and
36 with all values being an integer value.</p>
<p>In this example, we first develop the necessary R code to simulate
the patient data as well as a script to call the function and plot
example data generated with the new function. In this example you will
find the following R code:</p>
<ol style="list-style-type: decimal">
<li>
<a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/ChildPsychology.R" class="external-link">ChildPsychology.R</a>
- This file contains example code that call the patient simulation
function.</li>
<li>
<a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/ChildPsychologyV2.R" class="external-link">ChildPsychology2.R</a>
- This file contains example code that call the updated patient
simulation function.</li>
<li>
<a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/SimulatePatientOutcomeCHU9.R" class="external-link">SimulatePatientOutcomeCHU9.R</a>
- This file contains the R code for patient simulation. This version of
the file utilizes the UserParam variable in a way that required many
scenario cards to be setup in East Horizon Explore.<br>
</li>
<li>
<a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/SimulatePatientOutcomeCHU9V2.R" class="external-link">SimulatePatientOutcomeCHU9V2.R</a>
- This file contains the R code for patient simulation. This version of
the function utilizes an improved approach to make better use of the
native East Horizon Explore parameters and UserParam to make simulation
setup much easier.</li>
</ol>
<p>This example demonstrates the importance of simulating patient data
that is comparable to what is expected when the trial is executed and
illustrates the impact this may have on the power of the study. In
addition, it provides some insight into an efficient approach for
utilizing the native parameters in East Horizon Explore and the
UserParam that may be specified.</p>
</div>
<div class="section level2">
<h2 id="checking-the-patient-simulation-function">Checking the Patient Simulation Function<a class="anchor" aria-label="anchor" href="#checking-the-patient-simulation-function"></a>
</h2>
<p>The first step is to create an R function for simulating patient
outcomes. In the <a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/ChildPsychology.R" class="external-link">ChildPsychology.R</a>
file you will find example code that was used to test and call the
patient simulation function in <a href="https://github.com/Cytel-Inc/CyneRgy/blob/Dev/inst/Examples/ChildhoodAnxiety/RCode/SimulatePatientOutcomeCHU9.R" class="external-link">SimulatePatientOutcomeCHU9.R</a>.</p>
<p>First, the script sets up the parameters for the simulation. It
specifies the number of subjects (NumSub), the treatment each subject
receives (TreatmentID), and the mean and standard deviation for the two
treatments (Mean and StdDev). User-defined parameters for the mean and
standard deviation at follow-up for both the control and experimental
groups are also set (UserParam).</p>
<p>The SimulatePatientOutcome function is then called with these
parameters, and the results are stored in a dataframe, dfPatientData.
The dataframe contains the TreatmentID for each patient and the
corresponding simulated PatientOutcome.</p>
<p>The script then checks the validity of the simulated data. It
verifies that the response values (which represent changes in CHU9D
scores) lie within the expected range (-36 to 36), and that the mean
responses for the control and experimental groups match the expected
values.</p>
<p>As an example, one simulated data set could look like the
following:</p>
<p><img src="ChildhoodAnxiety_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="simulation-results">Simulation Results<a class="anchor" aria-label="anchor" href="#simulation-results"></a>
</h2>
<p>In a clinical trial setting, the sample size and statistical power
are key determinants of the study’s ability to detect true treatment
effects. When we assume a sample size of 234 and a true difference of 5
under normal data distribution, the statistical power is 90%. This power
signifies that we have a 90% chance of detecting a true treatment
effect, if one exists. Using East Horizon Explore the power computed
using simulation, see Figure 1.</p>
<p>However, the power figure drops when we introduce a more realistic
patient simulation method. In this context, the statistical power drops
to approximately 85%. This decrease implies that, under these more
realistic conditions, we would have an 85% chance of detecting a true
treatment effect, given the same sample size of 234 and true treatment
difference of 5, see Figure 2.</p>
<p>Knowing that a sample size of 234 is insufficient under realistic
conditions, it would be prudent to conduct further tests with larger
sample sizes. For instance, we could run simulations with sample sizes
ranging from 240 to 300, increasing in increments of 10. By examining
the resulting statistical power for each of these sample sizes utilizing
the realistic patient simulation, we could identify the smallest sample
size that brings us closest to a desired power of 90%. These simulation
were easily executed in East Horizon Explore and the results are
provided in Figure 3. From Figure 3, we can see that a sample size of
300 yields the desired 90% power. Thus, the trial should increase the
sample size from 234, the required sample size per standard sample size
calculations, to 300, the sample size needed under realistic patient
simulation.</p>
<p>If we were to proceed with the original sample size of 234 under
realistic conditions, our study would be under powered. Being under
powered means that our study would have a reduced likelihood of
identifying a significant treatment effect, even if one truly exists.
This could potentially lead to the erroneous conclusion that a
potentially effective treatment is ineffective, thereby missing an
opportunity for treatment advancement.</p>
<p>In summary, while a sample size of 234 yields a power of 90% under
normal data distribution, the power decreases to around 85% when we
implement a more realistic patient simulation. This highlights the
importance of considering realistic conditions when determining the
sample size for a study, to ensure adequate power to detect true
treatment effects.</p>
<p><strong>Figure 1</strong>: Power assuming data is normally
distributed <img src="ChildhoodAnxiety_files/PowerUnderNormalAssumptions.jpg" alt="Figure 1: Power assuming data is normally distributed"></p>
<p><strong>Figure 2</strong>: Power assuming realistic patient
simulation <img src="ChildhoodAnxiety_files/PowerWithRealisticSimulations.jpg" alt="Figure 2: Power assuming realistic patient simulation"></p>
<p><strong>Figure 3</strong>: Sample size determination using realistic
patient simulation <img src="ChildhoodAnxiety_files/SampleSizeDeterminationWithRealisticPatientSimulation.jpg" alt="Figure 3: Sample size determination using realistic patient simulation"></p>
</div>
<div class="section level2">
<h2 id="initial-r-code-developement">Initial R Code Developement<a class="anchor" aria-label="anchor" href="#initial-r-code-developement"></a>
</h2>
<p>The initial R code was developed assuming the user would supply
additional parameters via the UserParam variable in the R section of
East Horizon to supply the follow-up mean for each treatment and the
standard deviation for each treatment arm, since these variables are not
native inputs in East Horizon. The UserParams is a list that holds user
defined parameters. These parameters are used to define the mean and
standard deviation of the follow-up scores for both the control group
and experimental group in the simulation. Specifically, the UserParam
list includes the following elements:</p>
<p><strong>dMeanFollowUpCtrl</strong>: This parameter represents the
mean follow-up score for the control group. It is used to generate
simulated patient outcomes for individuals in the control group.</p>
<p><strong>dMeanFollowUpExp</strong>: This parameter signifies the mean
follow-up score for the experimental group. It is used to generate
simulated patient outcomes for individuals in the experimental
group.</p>
<p><strong>dStdDevFollowUpCtrl</strong>: This parameter denotes the
standard deviation of the follow-up scores for the control group. It
influences the spread of the simulated patient outcomes around the mean
for the control group.</p>
<p><strong>dStdDevFollowUpExp</strong>: This parameter indicates the
standard deviation of the follow-up scores for the experimental group.
It affects the spread of the simulated patient outcomes around the mean
for the experimental group.</p>
<p>In the original version of the code, we had to manually create 12
different cards to represent the 12 distinct scenarios. This was
necessary because the UserParam argument in our function was designed to
accept only a single value for each variable.</p>
<p>This approach, however, was not only labor-intensive but also
presented challenges in terms of data filtering. Specifically, it was
difficult to extract and display the desired information from these
scenarios. The process of setting up the scenarios and then filtering
the results to show what we wanted was cumbersome and inefficient. See
Figure 4 for the initial setup.</p>
<p>To improve this, we could consider modifying the function to accept
multiple values for each variable in the UserParam argument. This would
allow us to streamline the process of creating and managing different
scenarios, making the code more efficient and user-friendly for setting
up simulation scenarios.</p>
<p><strong>Figure 4</strong>: Initial input in East Horizon <img src="ChildhoodAnxiety_files/Approach1.jpg" alt="East Horizion R code Devolpment"> # Improved R Code</p>
<p>In utilizing the built-in parameters provided by East Horizon there
is a valuable feature: the ability to input multiple values for each
parameter on a single line. This streamlined the process, making it
easier to manage and adjust the parameters. Unfortunately, the current
UserParam list in our script does not offer this capability.</p>
<p>Reflecting on this, it’s clear that the original structure of our
input during the development phase can significantly impact the ease of
design exploration. By considering the user experience and optimizing
for efficiency in the early stages of code development, creates a less
cumbersome and more intuitive process. This approach would be
particularly beneficial when dealing with complex simulations or data
models, where the ability to easily adjust and experiment with different
parameters is crucial.</p>
<p>In light of this, it might be worth revising the patient simulation
function to utilize the UserParam in a slightly different way. This
change could enhance the flexibility and user-friendliness of our code,
making design input and exploration a smoother, more efficient process.
The major change was to use the UserParam to input the baseline
simulation information, since it stays constant for all scenarios, and
utilize the native input from East Horizon to input the follow-up
information, see Figure 5. This simple improvement allows the user to
have just 1 input card and simulate the same scenarios as previously
done with 10 cards. This also makes the native filters and other aspects
of East Horizon easier to use.</p>
<p><strong>Figure 5</strong>: Updated input in East Horizon <img src="ChildhoodAnxiety_files/Approach2Input.jpg" alt="East Horizion Improved R code"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by J. Kyle Wathen, Valeria A. G. Mazzanti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
