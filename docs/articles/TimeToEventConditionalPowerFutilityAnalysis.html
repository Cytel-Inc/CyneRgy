<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time-To-Event Weighted Conditional Power Futility Analysis • CyneRgy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time-To-Event Weighted Conditional Power Futility Analysis">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CyneRgy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/Overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Integration Specific Points</h6></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointInitialization.html">Initialization</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointAnalysis.html">Analysis (Test Statistic)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointEnrollment.html">Enrollment (Arrival Times)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointRandomization.html">Randomization</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointResponse.html">Response (Patient Simulation)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointDropout.html">Dropout</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointTreatmentSelection.html">Treatment Selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/ExampleOutline.html">Examples</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ContributingToCyneRgy.html">Contribute</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Cytel-Inc/CyneRgy"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Time-To-Event Weighted Conditional Power Futility Analysis</h1>
                        <h4 data-toc-skip class="author">Gabriel Potvin,
Valeria A. G. Mazzanti, Sheetal Solanki</h4>
            
            <h4 data-toc-skip class="date">October 15, 2025</h4>
      

      <div class="d-none name"><code>TimeToEventConditionalPowerFutilityAnalysis.Rmd</code></div>
    </div>

    
    
<div class="alert alert-primary" role="alert">
<p style="margin-bottom:0">
The following scripts are related to the <strong>Integration Point:
Analysis</strong>.
<a href="IntegrationPointAnalysis.html" class="alert-link">Click here
for more information about this integration point.</a>
</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This example demonstrates how to perform a time-to-event (TTE)
analysis with an evaluation of futility at an interim look by extending
East Horizon: Design’s functionalities using a custom R script for the
Analysis integration point. The analysis of patient data is based on the
Logrank test and the interim analysis evaluates futility based on a
<strong>Conditional Power</strong> threshold, which is computed using a
<strong>weighted hazard ratio</strong>.</p>
<p>In this example, we set up in East Horizon a <strong>Two Arm
Confirmatory</strong> trial with a <strong>single TTE endpoint</strong>
using the <em>Design task</em> and the <em>Logrank Test Given Accrual
Duration and Study Duration (Parallel Design)</em> option. In East
Horizon: Design, custom R scripts can only be applied during
simulations. Therefore, an analytical design must first be created,
after which simulations can be run based on its computation. During the
simulation, the futility evaluation from the original design is replaced
by the custom futility logic implemented in the R script.</p>
<div class="section level3">
<h3 id="why-do-we-need-r-integration-for-this-example">Why do we need R Integration for this example?<a class="anchor" aria-label="anchor" href="#why-do-we-need-r-integration-for-this-example"></a>
</h3>
<p>East Horizon: Design’s built-in analysis algorithms do not natively
support computation of a <strong>weighted conditional power</strong>
using both the assumed hazard ratio and the observed hazard ratio at any
interim analysis. This requires integrating a custom R file for the
Analysis step which will:</p>
<ul>
<li>Compute the Logrank test statistic and p-value at interim &amp;
final analyses.</li>
<li>Estimate the hazard ratio from interim data.</li>
<li>Compute conditional power using either the target hazard ratio
(i.e. original assumption), the estimated hazard ratio (i.e. observed at
each analysis), or <strong>a weighted combination of the
two</strong>.</li>
<li>Apply futility or efficacy decision rules based on pre-specified
boundaries, specified as conditional power thresholds.</li>
</ul>
<p>By integrating this R file, East Horizon users can perform adaptive
interim analyses with custom decision rules that are not supported in
the default framework, allowing more flexible and realistic trial
simulations.</p>
</div>
<div class="section level3">
<h3 id="what-does-the-r-function-do">What does the R function do?<a class="anchor" aria-label="anchor" href="#what-does-the-r-function-do"></a>
</h3>
<p>In the <a href="https://github.com/Cytel-Inc/CyneRgy/tree/main/inst/Examples/TimeToEventConditionalPowerFutilityAnalysis/R" class="external-link">R
directory of this example</a> you will find the following R file:</p>
<ul>
<li>
<p><strong><a href="https://github.com/Cytel-Inc/CyneRgy/tree/main/inst/Examples/TimeToEventConditionalPowerFutilityAnalysis/R/AnalzyeTTEWithConditinalPowerFutility.R" class="external-link">AnalzyeTTEWithConditinalPowerFutility.R</a></strong></p>
<p>This R file contains a function that analyzes simulated time-to-event
clinical trial data at interim or final analyses. It prepares the event
and censoring information, runs a log-rank test to compare treatment
groups, and then calculates conditional power based on either a target
hazard ratio, the estimated hazard ratio, or a weighted mix of both. It
applies futility rules using this conditional power at interim looks to
decide whether the trial should stop early or continue, and then uses
the traditional Logrank test for the efficacy/futility decision at the
final look. The function returns the test statistic, estimated hazard
ratio, conditional power, and a decision code indicating the
outcome.</p>
<p>For more information on this function, see the <a href="#technical-information-and-example-values">Technical Information
and Example Values</a> section below.</p>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="combining-it-all-together">Combining it all together…<a class="anchor" aria-label="anchor" href="#combining-it-all-together"></a>
</h3>
<p>The figure below illustrates where this example fits within the R
integration points of Cytel products, accompanied by flowcharts
outlining the general steps performed by the R code.</p>
<p><img src="TimeToEventConditionalPowerFutilityAnalysis_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="technical-information-and-example-values">Technical Information and Example Values<a class="anchor" aria-label="anchor" href="#technical-information-and-example-values"></a>
</h2>
<div class="alert alert-primary" role="alert">
<p style="margin-bottom:0">
This example is related to this R file:
<a href="https://github.com/Cytel-Inc/CyneRgy/tree/main/inst/Examples/TimeToEventConditionalPowerFutilityAnalysis/R/AnalzyeTTEWithConditinalPowerFutility.R" class="external-link alert-link">AnalzyeTTEWithConditinalPowerFutility.R</a>
</p>
</div>
<p>We begin by preparing the simulated trial data based on the design
parameters and current look index.</p>
<p>We then perform the Logrank test, which compares survival between
treatment and control arms. The test statistic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>)
is computed as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><msqrt><msup><mi>χ</mi><mn>2</mn></msup></msqrt><mo>⋅</mo><mo>sign</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mn>2</mn></msub><mo>−</mo><msub><mi>E</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Z = \sqrt{\chi^2} \cdot \operatorname{sign}(O_2 - E_2)
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
is the Logrank chi-square statistic.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>O</mi><mn>2</mn></msub><annotation encoding="application/x-tex">O_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>2</mn></msub><annotation encoding="application/x-tex">E_2</annotation></semantics></math>
are the observed and the expected number of events in the treatment
group.</li>
</ul>
<p>The corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>)
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><msubsup><mi>χ</mi><mn>1</mn><mn>2</mn></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>χ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
p = 1 - F_{\chi^2_1}(\chi^2)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><msubsup><mi>χ</mi><mn>1</mn><mn>2</mn></msubsup></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>χ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_{\chi^2_1}(\chi^2)</annotation></semantics></math>
is the cumulative distribution function (CDF) of a chi-square with 1
degree of freedom.</p>
<p>We also compute the standard error of log hazard ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">se</mtext><mrow><mo>ln</mo><mi>H</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\text{se}_{\ln HR}</annotation></semantics></math>)
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">se</mtext><mrow><mo>ln</mo><mi>H</mi><mi>R</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mi>n</mi><mo>⋅</mo><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">
\text{se}_{\ln HR} = \frac{1}{\sqrt{n \cdot r (1-r)}}
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the number of events at the time of analysis.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mtext mathvariant="normal">AllocInfo</mtext><mrow><mn>1</mn><mo>+</mo><mtext mathvariant="normal">AllocInfo</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">r = \frac{\text{AllocInfo}}{1+\text{AllocInfo}}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">AllocInfo</mtext><annotation encoding="application/x-tex">\text{AllocInfo}</annotation></semantics></math>
is the ratio of the treatment arm sample size to the control arm sample
size.</li>
</ul>
<p>Next, the conditional power
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">CP</annotation></semantics></math>),
or in other words the probability of ultimately crossing the efficacy
boundary given the interim results, is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>P</mi><mo>=</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>α</mi></msub><msqrt><mrow><mn>1</mn><mo>+</mo><mfrac><msub><mi>n</mi><mn>1</mn></msub><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><msub><mi>n</mi><mn>1</mn></msub></mrow></mfrac></mrow></msqrt><mo>−</mo><mi>Z</mi><msqrt><mfrac><msub><mi>n</mi><mn>1</mn></msub><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><msub><mi>n</mi><mn>1</mn></msub></mrow></mfrac></msqrt><mo>−</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><msup><mi>R</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><msqrt><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt><msqrt><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><msub><mi>n</mi><mn>1</mn></msub></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
CP = \Phi \left(
  z_\alpha \sqrt{1 + \frac{n_1}{n_2 - n_1}}
  - Z \sqrt{\frac{n_1}{n_2 - n_1}}
  - \ln(HR^*) \sqrt{r(1-r)} \sqrt{n_2 - n_1}
\right)
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi(.)</annotation></semantics></math>
is the standard normal cumulative distribution function (CDF).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>α</mi></msub><mo>=</mo><msup><mi>Φ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.025</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z_\alpha = \Phi^{-1}(0.025)</annotation></semantics></math>
is the critical value we set for the efficacy boundary on the Z-test
statistic scale (in this case, using a one-sided significance level of
2.5%).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_1</annotation></semantics></math>
is the number of events at the first look (interim analysis).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_2</annotation></semantics></math>
is the number of events at the second look (final analysis).</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msup><mi>R</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">HR^*</annotation></semantics></math>
depends on the computation option (see below).</li>
</ul>
<p>The futility decision rule at the interim analysis is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="normal">If </mtext><mspace width="0.333em"></mspace></mrow><mi>C</mi><mi>P</mi><mo>&lt;</mo><msub><mi>θ</mi><mtext mathvariant="normal">futility</mtext></msub><mo>→</mo><mtext mathvariant="normal">stop for futility.</mtext></mrow><annotation encoding="application/x-tex">
\text{If } CP &lt; \theta_{\text{futility}} \rightarrow \text{stop for futility.}
</annotation></semantics></math></p>
<p>The decision rule at the final analysis is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">If </mtext><mspace width="0.333em"></mspace></mrow><mi>Z</mi><mo>≤</mo><msub><mi>z</mi><mi>α</mi></msub><mo>→</mo><mtext mathvariant="normal">stop for efficacy.</mtext></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">If </mtext><mspace width="0.333em"></mspace></mrow><mi>Z</mi><mo>&gt;</mo><msub><mi>z</mi><mi>α</mi></msub><mo>→</mo><mtext mathvariant="normal">stop for futility.</mtext></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{cases}
    \text{If } Z \leq z_\alpha \rightarrow \text{stop for efficacy.} \\
    \text{If } Z &gt; z_\alpha \rightarrow \text{stop for futility.}
\end{cases}
</annotation></semantics></math></p>
<div class="section level3">
<h3 id="option-1-target-hazard-ratio">Option 1: Target Hazard Ratio<a class="anchor" aria-label="anchor" href="#option-1-target-hazard-ratio"></a>
</h3>
<p>In this option, the conditional power is computed using a
<strong>user-specified target hazard ratio</strong>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msup><mi>R</mi><mo>*</mo></msup><mo>=</mo><mtext mathvariant="normal">TargetHazardRatio</mtext></mrow><annotation encoding="application/x-tex">HR^* = \text{TargetHazardRatio}</annotation></semantics></math></p>
<p>To enable this option, set <strong>nComputationOption = 1</strong>
and provide values for both <strong>FutilityThreshold</strong> and
<strong>TargetHazardRatio</strong>, as shown in the table below.</p>
<table class="table">
<thead><tr class="header">
<th><strong>User parameter</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Example Value</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>nComputationOption</strong></td>
<td>Computation Option</td>
<td>Must be 1</td>
</tr>
<tr class="even">
<td><strong>FutilityThreshold</strong></td>
<td>Futility Threshold</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td><strong>TargetHazardRatio</strong></td>
<td>Target Hazard Ratio</td>
<td>0.66</td>
</tr>
</tbody>
</table>
<p>This option is equivalent to using East Horizon: Design’s built-in
functionality when specifying Futility information at the computation
stage, by selecting <em>Conditional Power</em> under <em>Futility
Boundary Family</em> and choosing <strong>Design HR</strong> for the
<em>Compute CP Using</em> input field.</p>
</div>
<div class="section level3">
<h3 id="option-2-estimated-hazard-ratio">Option 2: Estimated Hazard Ratio<a class="anchor" aria-label="anchor" href="#option-2-estimated-hazard-ratio"></a>
</h3>
<p>For this option, the conditional power is computed using an
<strong>estimated hazard ratio</strong> derived from interim data:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msup><mi>R</mi><mo>*</mo></msup><mo>=</mo><mover><mrow><mi>H</mi><mi>R</mi></mrow><mo accent="true">̂</mo></mover><mo>=</mo><mo>exp</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mi>Z</mi><mo>⋅</mo><msub><mtext mathvariant="normal">se</mtext><mrow><mo>ln</mo><mi>H</mi><mi>R</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
HR^* = \widehat{HR} = \exp\big( Z \cdot \text{se}_{\ln HR} \big)
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
is the Logrank test statistic, as defined before.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">se</mtext><mrow><mo>ln</mo><mi>H</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\text{se}_{\ln HR}</annotation></semantics></math>
is the standard error of log hazard ratio, as defined before.</li>
</ul>
<p>To enable this option, set <strong>nComputationOption = 2</strong>
and provide a value for <strong>FutilityThreshold</strong>, as shown in
the table below.</p>
<table class="table">
<thead><tr class="header">
<th><strong>User parameter</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Example Value</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>nComputationOption</strong></td>
<td>Computation Option</td>
<td>Must be 2</td>
</tr>
<tr class="even">
<td><strong>FutilityThreshold</strong></td>
<td>Futility Threshold</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p>This option is equivalent to using East Horizon: Design’s built-in
functionality when specifying Futility information at the computation
stage, by selecting <em>Conditional Power</em> under <em>Futility
Boundary Family</em> and choosing <strong>Estimated HR</strong> for the
<em>Compute CP Using</em> input field.</p>
</div>
<div class="section level3">
<h3 id="option-3-weighted-hazard-ratio">Option 3: Weighted Hazard Ratio<a class="anchor" aria-label="anchor" href="#option-3-weighted-hazard-ratio"></a>
</h3>
<p>In this option, the conditional power is computed using a
<strong>weighted hazard ratio</strong> that combines the estimated
hazard ratio from interim data with a user-specified target hazard
ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msup><mi>R</mi><mo>*</mo></msup><mo>=</mo><mi>H</mi><msub><mi>R</mi><mi>w</mi></msub><mo>=</mo><msub><mi>w</mi><mtext mathvariant="normal">est</mtext></msub><mo>⋅</mo><mover><mrow><mi>H</mi><mi>R</mi></mrow><mo accent="true">̂</mo></mover><mo>+</mo><msub><mi>w</mi><mtext mathvariant="normal">target</mtext></msub><mo>⋅</mo><mi>H</mi><msub><mi>R</mi><mtext mathvariant="normal">target</mtext></msub></mrow><annotation encoding="application/x-tex">
HR^* = HR_w = w_{\text{est}} \cdot \widehat{HR} + w_{\text{target}} \cdot HR_{\text{target}}
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mtext mathvariant="normal">est</mtext></msub><annotation encoding="application/x-tex">w_{\text{est}}</annotation></semantics></math>
is the weight assigned to the estimated hazard ratio.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mtext mathvariant="normal">target</mtext></msub><annotation encoding="application/x-tex">w_{\text{target}}</annotation></semantics></math>
is the weight assigned to the target hazard ratio.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>R</mi><mtext mathvariant="normal">target</mtext></msub></mrow><annotation encoding="application/x-tex">HR_{\text{target}}</annotation></semantics></math>
is the user-specified target hazard ratio.</li>
</ul>
<p>To enable this option, set <strong>nComputationOption = 3</strong>
and provide values for <strong>FutilityThreshold</strong>,
<strong>TargetHazardRatio</strong>, <strong>WeightEstimatedHR</strong>,
and <strong>WeightTargetHR</strong>, as shown in the table below.</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="50%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th><strong>User parameter</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Example Value</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>nComputationOption</strong></td>
<td>Computation Option</td>
<td>Must be 3</td>
</tr>
<tr class="even">
<td><strong>FutilityThreshold</strong></td>
<td>Futility Threshold</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td><strong>TargetHazardRatio</strong></td>
<td>Target Hazard Ratio</td>
<td>0.7</td>
</tr>
<tr class="even">
<td><strong>WeightEstimatedHR</strong></td>
<td>Weight assigned to the estimated hazard ratio</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td><strong>WeightTargetHR</strong></td>
<td>Weight assigned to the target hazard ratio</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<p>Unlike Options 1 and 2, this option <strong>cannot</strong> be
implemented using East Horizon: Design’s built-in functionality. It is
only available through R integration.</p>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>We ran 10,000 simulation replicates for each configuration using the
example values of the tables above. The results are summarized
below:</p>
<table class="table">
<thead><tr class="header">
<th><strong>Option</strong></th>
<th><strong>Average Power at Termination</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Option 1 (built-in)</td>
<td>0.905</td>
</tr>
<tr class="even">
<td>Option 1 (with R)</td>
<td>0.898</td>
</tr>
<tr class="odd">
<td>Option 2 (built-in)</td>
<td>0.901</td>
</tr>
<tr class="even">
<td>Option 2 (with R)</td>
<td>0.895</td>
</tr>
<tr class="odd">
<td>Option 3 (with R, simulated on Option 1)</td>
<td>0.900</td>
</tr>
<tr class="even">
<td>Option 3 (with R, simulated on Option 2)</td>
<td>0.920</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="43%">
<col width="18%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th><strong>Option</strong></th>
<th><strong>Futility stops at analysis 1</strong></th>
<th><strong>Futility stops at analysis 2</strong></th>
<th><strong>Total futility stops</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Option 1 (built-in)</td>
<td>11</td>
<td>941</td>
<td>952</td>
</tr>
<tr class="even">
<td>Option 1 (with R)</td>
<td>12</td>
<td>1009</td>
<td>1021</td>
</tr>
<tr class="odd">
<td>Option 2 (built-in)</td>
<td>514</td>
<td>480</td>
<td>994</td>
</tr>
<tr class="even">
<td>Option 2 (with R)</td>
<td>536</td>
<td>519</td>
<td>1055</td>
</tr>
<tr class="odd">
<td>Option 3 (with R, simulated on Option 1)</td>
<td>8</td>
<td>993</td>
<td>1001</td>
</tr>
<tr class="even">
<td>Option 3 (with R, simulated on Option 2)</td>
<td>4</td>
<td>800</td>
<td>804</td>
</tr>
</tbody>
</table>
<p>For Options 1 and 2, the results obtained via the built-in East
Horizon functionality are almost identical to those produced using the R
integration, confirming the correctness of the custom
implementation.</p>
<p>For Option 3, results depend on which analytical design (Option 1 or
Option 2) was used as the baseline for simulation. As this method is not
available using East Horizon: Design’s built-in functionality, the
sample size and number of events required to reach a target power using
this method must be identified by running a range of simulations with
varying sample size and number of events values. The weighted hazard
ratio approach can be particularly valuable in situations where users
want to balance evidence from observed interim data with prior
expectations about the treatment effect.</p>
<p>In conclusion, these results demonstrate that the R script
successfully reproduces East Horizon’s built-in functionality where
available and extends its capabilities to new features such as weighted
hazard ratios.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by J. Kyle Wathen, Valeria A. G. Mazzanti, Gabriel Potvin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
