<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Assurance of Consecutive Studies • CyneRgy</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Assurance of Consecutive Studies">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CyneRgy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/Overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Integration Specific Points</h6></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointInitialization.html">Initialization</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointAnalysis.html">Analysis (Test Statistic)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointEnrollment.html">Enrollment (Arrival Times)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointRandomization.html">Randomization (Assignment of Subjects)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointResponse.html">Response (Patient Simulation)</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointDropout.html">Dropout</a></li>
    <li><a class="dropdown-item" href="../articles/IntegrationPointTreatmentSelection.html">Treatment Selection</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/ExampleOutline.html">Examples Outline</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Patient Simulation</h6></li>
    <li><a class="dropdown-item" href="../articles/2ArmNormalOutcomePatientSimulationDescription.html">2-Arm, Normal Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/2ArmTimeToEventOutcomePatientSimulationDescription.html">2-Arm, Time-to-Event Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/2ArmBinaryOutcomePatientSimulation.html">2-Arm, Binary Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/2ArmNormalRepeatedMeasuresResponseGeneration.html">2-Arm, Repeated Measure</a></li>
    <li><a class="dropdown-item" href="../articles/ChildhoodAnxiety.html">Childhood Anxiety Trial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/2ArmNormalOutcomeAnalysisDescription.html">2-Arm, Normal Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/2ArmTimeToEventOutcomeAnalysisDescription.html">2-Arm, Time-To-Event Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/2ArmBinaryOutcomeAnalysisDescription.html">2-Arm, Binary Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Treatment Selection</h6></li>
    <li><a class="dropdown-item" href="../articles/TreatmentSelectionDescription.html">Binary Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/AssuranceConsecutiveStudies.html">Bayesian Assurance of Consecutive Studies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other Integration Points</h6></li>
    <li><a class="dropdown-item" href="../articles/GeneratePoissonArrival.html">Poisson Arrival Times</a></li>
    <li><a class="dropdown-item" href="../articles/PatientDropout.html">Patient Dropout</a></li>
    <li><a class="dropdown-item" href="../articles/PatientRandomization.html">Patient Randomization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ContibutingToCyneRgy.html">Contribute</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Cytel-Inc/CyneRgy"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian Assurance of Consecutive Studies</h1>
                        <h4 data-toc-skip class="author">J. Kyle Wathen
and Laurent Spiess</h4>
            
            <h4 data-toc-skip class="date">April 17, 2025</h4>
      

      <div class="d-none name"><code>AssuranceConsecutiveStudies.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The intent of this example is to demonstrate the computation of
Bayesian assurance, or probability of success, through the integration
of R with Cytel products using a series of examples. These examples
begin with a 2-arm, normal outcome, fixed sample trial assuming a
non-standard prior for computation of assurance. The examples progress
to a more complex setting of computing assurance for a sequence of a
phase 2 trial with normal outcomes followed by a phase 3 trial where the
outcome is time-to-event.</p>
<p>Once CyneRgy is installed, you can load this example in RStudio with
the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CyneRgy</span><span class="fu">::</span><span class="fu"><a href="../reference/RunExample.html">RunExample</a></span><span class="op">(</span> <span class="st">"AssuranceConsecutiveStudies"</span> <span class="op">)</span></span></code></pre></div>
<p>Running the command above will load the RStudio project in
RStudio.</p>
<p><strong>East Workbook</strong>: <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/Assurance.cywx" class="external-link">AssuranceConsecutiveStudies.cywx</a></p>
<p><strong>RStudio Project File</strong>: <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/Assurance.Rproj" class="external-link">AssuranceConsecutiveStudies.Rproj</a></p>
<p>In the <a href="https://github.com/Cytel-Inc/CyneRgy/tree/main/inst/Examples/AssuranceConsecutiveStudies/R" class="external-link">R
directory of this example</a> you will find the R files used in the
examples.</p>
<p>The examples will all contain two treatments, Standard of Care (S)
and Experimental (E) and are follows:</p>
<ol style="list-style-type: decimal">
<li>Fixed sample design using a mixture of normal distributions for
computation of assurance</li>
<li>Expand example 1 to a group sequential design with an interim for
futility based on a Bayesian predictive probability</li>
<li>Fixed design with a time-event-event outcome, this example provides
the basis and a comparison for the phase 2 followed by a phase 3 example
considered last</li>
<li>Two consecutive studies, phase 2 with a normal endpoint followed by
a phase 3 with a normal endpoint</li>
<li>Two consecutive studies, phase 2 with a normal endpoint followed by
a phase 3 with a time-to-event outcome</li>
</ol>
</div>
<div class="section level2">
<h2 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h2>
<div class="section level3">
<h3 id="study-design">Study Design<a class="anchor" aria-label="anchor" href="#study-design"></a>
</h3>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 80 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
</ul>
<p>Denote the minimum acceptable value by MAV. For patients receiving
treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
= S or E, we assume the outcomes Y
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>j</mi></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sim N( \mu_j, \sigma^2)</annotation></semantics></math>
where, for simplicity,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>
is unknown and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is the known, fixed quantity. We assume <em>a priori</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>j</mi></msub><mo>∼</mo></mrow><annotation encoding="application/x-tex">\mu_j \sim</annotation></semantics></math>
Normal(
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mi>j</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau_j^2</annotation></semantics></math>=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>1000</mn><mn>2</mn></msup><annotation encoding="application/x-tex">1000^2</annotation></semantics></math>
), for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">j=</annotation></semantics></math>
S or E. At the end of the study the following is computed:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>E</mi></msub><mo>&gt;</mo><msub><mi>μ</mi><mi>S</mi></msub><mo>+</mo><mi>M</mi><mi>A</mi><mi>V</mi><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and</mtext></mrow></mrow><annotation encoding="application/x-tex">
    \rho = Pr( \mu_E &gt; \mu_S + MAV | data ) \text{ and}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="normal">If </mtext><mspace width="0.333em"></mspace></mrow><mi>ρ</mi><mo>&gt;</mo><msub><mi>P</mi><mi>U</mi></msub><mo>⟹</mo><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> Go </mtext><mspace width="0.333em"></mspace></mrow></mrow><annotation encoding="application/x-tex">  
    \text{If } \rho &gt; P_U \implies \text{ Go }
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> If </mtext><mspace width="0.333em"></mspace></mrow><mi>ρ</mi><mo>≤</mo><msub><mi>P</mi><mi>U</mi></msub><mo>⟹</mo><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> No-Go </mtext><mspace width="0.333em"></mspace></mrow></mrow><annotation encoding="application/x-tex">
    \text{ If } \rho \leq P_U \implies \text{ No-Go }
</annotation></semantics></math></p>
<p>For decision making we assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P_U = 0.8</annotation></semantics></math>.
For assurance, a mixture of normal distributions is assumed. The
assurance prior is specified in terms of the prior weight, mean, and
variance for each component of the mixture. For simplicity, we assume
mixture of two normal distributions as follows:</p>
<ul>
<li>Weight: 25% on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.05</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N( 0, 0.05 )</annotation></semantics></math>
</li>
<li>Weight: 75% on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.7</mn><mo>,</mo><msup><mn>0.3</mn><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N( 0.7, 0.3^2)</annotation></semantics></math>
</li>
</ul>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="r-integration">R Integration<a class="anchor" aria-label="anchor" href="#r-integration"></a>
</h3>
<p>In order to evaluate the design above, one can develop an R function
for analysis that can be called from East during simulation. By
replacing only the analysis function with an R function, one can obtain
the frequentist operating characteristics of the Bayesian design using
East. In addition, by replacing how the patient data is simulated one
can obtain the Bayesian assurance. Specifically, in the simulation when
the patient data is simulated an R function will first sample the
assurance prior then sample the patient data. The resulting power of
this simulation will be the Bayesian assurance assuming the 2 component
prior given above.</p>
<p>There is often a need for examination of posterior distribution of
both observed and true treatment differences given a Go decision. These
posterior distributions can be useful for planning the next phase of
study and understanding potential risks. Obtaining the posterior
distributions is described in the next section and they are applied to
the phase 2 followed by phase 3 in later sections.</p>
<div class="section level4">
<h4 id="required-r-functions">Required R Functions<a class="anchor" aria-label="anchor" href="#required-r-functions"></a>
</h4>
<p>The two functions that are needed to evaluate this design and obtain
the Bayesian assurance are the analysis function,
AnayzeUsingBayesianNormals, and patient simulation function,
SimulatePatientOutcomeNormalAssurance.</p>
<p>To help understand the AnayzeUsingBayesianNormals one must first
derive the posterior distributions.</p>
<p>After observing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
patients on treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">j =</annotation></semantics></math>
S or E, the posterior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\mu_j</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">|</mo><mover><mi>y</mi><mo accent="true">‾</mo></mover><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>θ</mi><mi>j</mi><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>τ</mi><mi>j</mi><mrow><mn>2</mn><mo>*</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mu_j | \bar{y} \sim N( \theta_j^*, \tau_j^{2*} )
</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>θ</mi><mi>j</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><mrow><mfrac><msub><mi>θ</mi><mi>j</mi></msub><msubsup><mi>τ</mi><mi>j</mi><mn>2</mn></msubsup></mfrac><mo>+</mo><mfrac><mi>n</mi><msup><mi>σ</mi><mn>2</mn></msup></mfrac><mover><mi>y</mi><mo accent="true">‾</mo></mover></mrow><mrow><mfrac><mn>1</mn><msubsup><mi>τ</mi><mi>j</mi><mn>2</mn></msubsup></mfrac><mo>+</mo><mfrac><mn>1</mn><msup><mi>σ</mi><mn>2</mn></msup></mfrac></mrow></mfrac><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mfrac><mn>1</mn><msubsup><mi>τ</mi><mi>j</mi><mrow><mn>2</mn><mo>*</mo></mrow></msubsup></mfrac><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>τ</mi><mi>j</mi><mn>2</mn></msubsup></mfrac><mo>+</mo><mfrac><mi>n</mi><msup><mi>σ</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">
\theta_j^* = \frac{\frac{\theta_j}{\tau_j^2} + \frac{n}{\sigma^2}\bar{y}}{\frac{1}{\tau_j^2}+ \frac{1}{\sigma^2}} \text{ and }
\frac{1}{\tau_j^{2*}} = \frac{1}{\tau_j^2} +\frac{n}{\sigma^2}
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="integration-with-east">Integration with East<a class="anchor" aria-label="anchor" href="#integration-with-east"></a>
</h4>
<p>Using the East workbook named Assurance.cywx with East version
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">&gt;=</annotation></semantics></math>
6.5.4 the Example 1 simulation can be used to obtain the results found
in the next section. After editing the simulation, on the User Define R
Functions the Generate Response and Compute Test Statistic are both
replaced with R code. The Generate Response utilizes the
SimulatePatientOutcomeNormalAssurance found in the file named <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/SimulatePatientOutcomeNormalAssurance.R" class="external-link">R/SimulatePatientOutcomeNormalAssurance.R</a>
and has variables as shown below. For the Compute Test Statistic the
function name AnalyzeUsingBayesianNormals found in <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/AnalyzeUsingBayesianNormals.R" class="external-link">R/AnalyzeUsingBayesianNormals.R</a>
with input shown below.</p>
<div class="float">
<img src="Example1GenerateResponseInput.jpg" alt="Input for generate response in East"><div class="figcaption">Input for generate response in East</div>
</div>
<div class="float">
<img src="Example1TestStatisticInput.jpg" alt="Input for test statistitic input in East"><div class="figcaption">Input for test statistitic input in East</div>
</div>
</div>
<div class="section level4">
<h4 id="integration-with-east-horizon-explore">Integration with East Horizon Explore<a class="anchor" aria-label="anchor" href="#integration-with-east-horizon-explore"></a>
</h4>
<p>The setup in East Horizon Explore is very similar to East. East
Horizon Explore utilizes the same R functions. In the Responses tab, the
Generate Response utilizes the SimulatePatientOutcomeNormalAssurance
found in the file named <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/SimulatePatientOutcomeNormalAssurance.R" class="external-link">R/SimulatePatientOutcomeNormalAssurance.R</a>
and has variables as shown below. For the Compute Test Statistic the
function name AnalyzeUsingBayesianNormals found in <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/AnalyzeUsingBayesianNormals.R" class="external-link">R/AnalyzeUsingBayesianNormals.R</a>
with input shown below.</p>
<div class="float">
<img src="Example1GenerateResponseSolara.jpg" alt="Input for generate response in East Horizon Explore"><div class="figcaption">Input for generate response in East Horizon
Explore</div>
</div>
<div class="float">
<img src="Example1TestStatisticSolara.jpg" alt="Input for test statistic in East Horizon Explore"><div class="figcaption">Input for test statistic in East Horizon
Explore</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>The probability of a Go is 15.3% and the probability of a No-Go is
84.7%.</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h2>
<div class="section level3">
<h3 id="study-design-1">Study Design<a class="anchor" aria-label="anchor" href="#study-design-1"></a>
</h3>
<p>Same study design as previous example, however, this design includes
an interim analysis to check for futility when 50% of the patients have
their outcome observed. The futility rule is based on a Bayesian
predictive probability of a No-Go at the end of the study. That is, at
the interim analysis if it is likely that the study will make a No-Go
decision at the final analysis, then the study is stopped early for
futility.</p>
<p>Denote the data at the interim analysis by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
and data for patients enrolled after the IA by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>.
If the predictive probability of a No-Go at the final analysis is
greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>U</mi><mrow><mi>F</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>90</mn></mrow><annotation encoding="application/x-tex">PU_{Futility} = 90</annotation></semantics></math>%
then the trial is stopped for futility. Specifically, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">End of Study No-Go</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mi>P</mi><msub><mi>U</mi><mrow><mi>F</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>90</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">Pr( \text{End of Study No-Go} | X_1 ) &gt; PU_{Futility} = 90\%</annotation></semantics></math>
then the trial is stopped for futility. The prediction formula
becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">End of Study No-Go</mtext><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo stretchy="false" form="prefix">{</mo><mi>P</mi><mi>r</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>μ</mi><mi>E</mi></msub><mo>&gt;</mo><msub><mi>μ</mi><mi>S</mi></msub><mo>+</mo><mi>M</mi><mi>A</mi><mi>V</mi><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>&gt;</mo><mi>P</mi><mi>U</mi><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>&gt;</mo><mi>P</mi><msub><mi>U</mi><mrow><mi>F</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
Pr( \text{End of Study No-Go} | X_1 ) = Pr[ \{ Pr( \mu_E &gt; \mu_S + MAV | X_1, X_2 ) &gt; PU \} | X_1  ] &gt; PU_{Futility}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="r-integration-1">R Integration<a class="anchor" aria-label="anchor" href="#r-integration-1"></a>
</h3>
<p>In order to evaluate the design above, one can develop an R function
for analysis that can be called from East during simulation. By
replacing only the analysis function with an R function, one can obtain
the frequentist operating characteristics of the Bayesian design using
East that includes the interim analysis and futility check based on a
Bayesian predictive probability. In addition, by replacing how the
patient data is simulated one can obtain the Bayesian assurance.
Specifically, in the simulation when the patient data is simulated an R
function will first sample the assurance prior then sample the patient
data. The resulting power of this simulation will be the Bayesian
assurance assuming the 2 component prior given in Example 1 and
including the futility check.</p>
<div class="section level4">
<h4 id="required-r-functions-1">Required R Functions<a class="anchor" aria-label="anchor" href="#required-r-functions-1"></a>
</h4>
<p>Same as example 1, just need to provide the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>U</mi><mrow><mi>F</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PU_{Futility}</annotation></semantics></math>
parameter. The same R code function is used for Example 1 and 2. The
only difference between this example and Example 1 is the addition of
the dPUFutility and the interim analysis.</p>
<div class="float">
<img src="Example2TestStatisticInput.jpg" alt="Input for test statistitic input"><div class="figcaption">Input for test statistitic input</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="results-1">Results<a class="anchor" aria-label="anchor" href="#results-1"></a>
</h3>
<p>The results of the design are as follows:</p>
<ul>
<li>The probability of an end of study Go is: 0.1478</li>
<li>The probability of an end of study No-Go (Stop) is: 0.2656</li>
<li>The probability of futility at the interim: 0.5866</li>
<li>The probability of a Go conditional on not stopping at the interim:
0.357523</li>
<li>The probability of a No-Go conditional on not stopping at the
interim: 0.642477</li>
</ul>
<p>The posterior mean of the true delta,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>E</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">\mu_E-\mu_S</annotation></semantics></math>,
given a Go decision is: 0.992</p>
<p>The summary of the true delta given a Go decision is:</p>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##   0.023   0.823   0.990   0.992   1.151   2.009</span></span></code></pre>
<p>The scaled posterior distribution of the true delta given a Go
decision is:</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h2>
<div class="section level3">
<h3 id="study-design-2">Study Design<a class="anchor" aria-label="anchor" href="#study-design-2"></a>
</h3>
<p>This study is a two-arm fixed sample size design with a time-to-event
endpoint. Total sample size is 600 patients with 300 patients per arm.
There is a single analysis when 50% of the patients have had their event
observed. A hazard ratio (HR) below 1 is considered to favor the
experimental arm. The analysis is assumed to be a cox proportional
hazard model where a Go decision is made if the p-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\leq</annotation></semantics></math>
0.025.</p>
<p>For assurance, a bi-modal prior on the Log(HR) is used. The
components of the prior are:</p>
<ul>
<li>Weight: 25% on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.02</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N( 0, 0.02 )</annotation></semantics></math>
</li>
<li>Weight: 75% on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta( 2, 2)</annotation></semantics></math>,
rescaled between -0.4 and 0.</li>
</ul>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="r-integration-2">R Integration<a class="anchor" aria-label="anchor" href="#r-integration-2"></a>
</h3>
<div class="section level4">
<h4 id="required-r-functions-2">Required R Functions<a class="anchor" aria-label="anchor" href="#required-r-functions-2"></a>
</h4>
<p>This are 3 required R files and functions needed to evaluate this
design. The first file is used to initialize the R environment and load
the survival package. The second file is used to perform the analysis
using a Cox model. The third required file is used to first simulate the
true HR from the prior and then simulate the patient data using the
sampled HR.</p>
<p>The initialize function InitializeSurvival is found in the file <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/InitializeSurvival.R" class="external-link">R/SimulatePatientOutcomeNormalAssurance.R</a>.
The function used for analysis is AnalyzeSurivalDataUsingCoxPH, is found
in the file <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/AnalyzeSurvivalDataUsingCoxPH.R" class="external-link">R/AnalyzeSurvivalDataUsingCoxPH.R</a>
The function used for simulating patient data is
SimulatePatientOutcomeNormalAssurance and is found in the file <a href="https://github.com/Cytel-Inc/CyneRgy/blob/main/inst/Examples/AssuranceConsecutiveStudies/R/SimulatePatientOutcomeNormalAssurance.R" class="external-link">R/SimulatePatientOutcomeNormalAssurance.R</a></p>
</div>
<div class="section level4">
<h4 id="integration-with-east-1">Integration with East<a class="anchor" aria-label="anchor" href="#integration-with-east-1"></a>
</h4>
<p>The required user input for generating patient survival in East is
provided below.</p>
<div class="float">
<img src="Example3GenerateResponseInput.jpg" alt="Input for generate response"><div class="figcaption">Input for generate response</div>
</div>
</div>
<div class="section level4">
<h4 id="integration-with-east-horizon-explore-1">Integration with East Horizon Explore<a class="anchor" aria-label="anchor" href="#integration-with-east-horizon-explore-1"></a>
</h4>
<p>The required user input for generating patient survival in East
Horizon Explore is provided below.</p>
<div class="float">
<img src="Example3GenerateResponseSolara.jpg" alt="Input for generate response"><div class="figcaption">Input for generate response</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="results-2">Results<a class="anchor" aria-label="anchor" href="#results-2"></a>
</h3>
<p>The probability of a Go decision is 33% and the probability of a
No-Go Decision is is 67%. The posterior distribution of the true Log( HR
) given a Go decision is:</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-4---two-consecutive-studies-and-de-risking">Example 4 - Two Consecutive Studies and De-risking<a class="anchor" aria-label="anchor" href="#example-4---two-consecutive-studies-and-de-risking"></a>
</h2>
<p>In this section we explore computing assurance and conditional
assurance for two consecutive studies. A phase 2 with normal endpoints
(similar setup to Example 1) followed by a Phase 3 with a normal
endpoint.</p>
<p>The goal is to understand how much the phase 3 trial can be de-risked
by first running a phase 2 study to gather additional information.
De-risking is determined by comparing the probability of a No-Go in a
phase 3 if the phase 2 was skipped versus the probability of a No-Go in
phase 3 if the phase 2 was first conducted and successful. Specifically,
we compute the assurance of the phase 3 conditional on a Go decision in
phase 2.</p>
<div class="section level3">
<h3 id="study-design---phase-2">Study Design - Phase 2<a class="anchor" aria-label="anchor" href="#study-design---phase-2"></a>
</h3>
<p>Same priors as Example 1.</p>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 80 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
<li>MAV = 0.6</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P_U = 0.8</annotation></semantics></math></li>
</ul>
<div class="section level4">
<h4 id="results-for-phase-2">Results For Phase 2<a class="anchor" aria-label="anchor" href="#results-for-phase-2"></a>
</h4>
<p>The probability of a Go is 26.7% and the probability of a No-Go is
73.3%.</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="study-design---phase-3">Study Design - Phase 3<a class="anchor" aria-label="anchor" href="#study-design---phase-3"></a>
</h3>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 200 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
<li>MAV = 0.6</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P_U = 0.5</annotation></semantics></math></li>
</ul>
<p>With MAV = 0.6 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P_U = 0.5</annotation></semantics></math>
this design is equivalent to using a t-test because the critical value
would be 0.6 and having a posterior probability greater than 0.5 would
indicate that the estimated treatment difference is above the critical
value.</p>
<div class="section level4">
<h4 id="results-for-phase-3">Results For Phase 3<a class="anchor" aria-label="anchor" href="#results-for-phase-3"></a>
</h4>
<p>The probability of a Go in Phase 3 is 46% and the probability of a
No-Go is 54%.</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="phase-2-followed-by-phase-3">Phase 2 followed by Phase 3<a class="anchor" aria-label="anchor" href="#phase-2-followed-by-phase-3"></a>
</h3>
<p>Using a Phase 2 design like above.</p>
<p><em>Phase 2</em></p>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 80 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
<li>MAV = 0.6</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P_U = 0.8</annotation></semantics></math></li>
</ul>
<p>If the Phase 2 makes a Go decision then the Phase 3 is conducted as
follows:</p>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 200 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
<li>MAV = 0.6</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P_U = 0.5</annotation></semantics></math></li>
</ul>
<div class="section level4">
<h4 id="results-for-phase-2-followed-by-phase-3">Results For Phase 2 Followed by Phase 3<a class="anchor" aria-label="anchor" href="#results-for-phase-2-followed-by-phase-3"></a>
</h4>
<p>Given a Go decision is made in Phase 2, the probability of a Go in
Phase 3 is 84.8% and the probability of a No-Go is 15.2%.</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="de-risking">De-risking<a class="anchor" aria-label="anchor" href="#de-risking"></a>
</h4>
<p>Comparing the option of running only a Phase 3 versus a Phase 2
followed by a Phase 3 if Phase 2 is successful, the probability of Go in
phase 3 increases from 46% to 84.8% and the probability of a No-Go in
Phase 3 decreases from 54% to 15.2%.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-5---two-consecutive-studies-and-de-risking">Example 5 - Two Consecutive Studies and De-risking<a class="anchor" aria-label="anchor" href="#example-5---two-consecutive-studies-and-de-risking"></a>
</h2>
<p>In this section we explore computing assurance and conditional
assurance for two consecutive studies. A phase 2 with normal endpoints
(similar setup to Example 1) followed by a Phase 3 with a time-to-event
endpoint.</p>
<div class="section level3">
<h3 id="study-design-phase-2">Study Design Phase 2<a class="anchor" aria-label="anchor" href="#study-design-phase-2"></a>
</h3>
<p>Same priors as Example 1.</p>
<p>Fixed sample, with normally distributed outcomes Y.</p>
<ul>
<li>Sample size: 80 patients per arm</li>
<li>Assume standard deviation is known:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.9</mn></mrow><annotation encoding="application/x-tex">\sigma = 1.9</annotation></semantics></math>
</li>
<li>MAV = 0.6</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>U</mi></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P_U = 0.8</annotation></semantics></math></li>
</ul>
<div class="section level4">
<h4 id="results-for-phase-2-1">Results For Phase 2<a class="anchor" aria-label="anchor" href="#results-for-phase-2-1"></a>
</h4>
<p>The probability of a Go is 26.7% and the probability of a No-Go is
73.3%.</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="study-design-phase-3">Study Design Phase 3<a class="anchor" aria-label="anchor" href="#study-design-phase-3"></a>
</h3>
<p>This study is a two-arm fixed sample size design with a time-to-event
endpoint. Total sample size is 600 patients with 300 patients per arm.
There is a single analysis when 50% of the patients have had their event
observed. A hazard ratio (HR) below 1 is considered to favor the
experimental arm. The analysis is assumed to be a cox proportional
hazard model where a Go decision is made if the p-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\leq</annotation></semantics></math>
0.025.</p>
<p>The relationship between the continuous endpoint in phase 2 and the
time-to-event endpoint in phase 3 is assumed to follow a linear
function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mspace width="0.222em"></mspace><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi><mspace width="0.222em"></mspace><mi>H</mi><mi>R</mi><mspace width="0.222em"></mspace><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> in phase 3 = 0.1 − 0.4 ∗ ( true treatment difference in phase 2)</mtext></mrow></mrow><annotation encoding="application/x-tex"> 
log(\ True \ HR\ ) \text{ in phase 3 = 0.1 − 0.4 ∗ ( true treatment difference in phase  2)}
</annotation></semantics></math></p>
<p>Note that the relationship is established on the true treatment
effects. Since the phase 2 provides a prior on the true treatment
different and we have the linear link function between the true
treatment difference and the true HR, we do not need to specify the
prior on the true HR like in Example 3.</p>
</div>
<div class="section level3">
<h3 id="east-r-integration">East-R Integration<a class="anchor" aria-label="anchor" href="#east-r-integration"></a>
</h3>
<p>For this example, in the East workbook Example 5 - Phase 2 is used to
simulate the phase 2 and Example 5 - Phase 3 is used to simulate the
phase 3 for both the conditional and unconditional assurance
calculations. When the phase 2 is simulated, the true treatment
different is sampled from the prior is saved in the output file from
phase 2. Both the conditional and unconditional phase 3 use an R
initialize function to read in the output from the phase 2 and obtain
the true treatment difference which is then converted to the log of the
true HR given the link function above. Note, for the unconditional
assurance an alternative approach would be to sample the phase 2 prior
directly rather then read the output from phase 2. However, reading the
true values in from the phase 2 creates a more consistent comparison
between the conditional and unconditional assurance calculations and a
more accurate estimate of the benefit of running the phase 2 prior to
the phase 3.</p>
<div class="section level4">
<h4 id="required-r-function">Required R Function<a class="anchor" aria-label="anchor" href="#required-r-function"></a>
</h4>
<p>For the phase 2, the same functions are needed as Example 2.</p>
<p>The two functions that are needed to evaluate this design and obtain
the Bayesian assurance are the analysis function,
AnayzeUsingBayesianNormals, and patient simulation function,
SimulatePatientOutcomeNormalAssurance.</p>
<p>For the phase 3, three functions are needed: 1)
ReadExample5Phase2Output, 2) AnalyzeSurvivalDataUsingCoxPh, and 3)
SimulatePatientSurvivalAssuranceUsingPh2Pior and the functions are
located in the R directory in the file with the matching file name. The
ReadExample5Phase2Output is called from the Initialize R Environment in
East and loads the survival package as it is needed for the coxph
function and also reads in the true treatment difference from phase 2.
Note the use of the &lt;&lt;- operator to create a global variables
vPrior, the vector with the treatment difference, and nSimIndex to keep
track of which simulation index or replication the simulation is
executing when the call to SimulatePatientSurvivalAssuranceUsingPh2Pior
is executed. Both vPrior and nSimIndex are utilized in the function
SimulatePatientSurvivalAssuranceUsingPh2Pior and the nSimIndex variable
is updated with each call.</p>
<p>The function ReadExample5Phase2Output utilizes the UserParam
variables from East and if UserParam$bConditionalOnGo is 1, then only
the true treatment effects that resulted in a Go decision in Phase 2 are
retained allowing the simulation to compute the conditional assurance.
Note that the number of replications used in simulating the phase 3 for
conditional assurance must be less than or equal to the number of
simulated phase 2 trials that were successful. If
UserParam$bConditionalOnGo is 0 then all true treatment effects sampled
in the Phase 2 are retained allowing the simulation to compute the
unconditional assurance.</p>
</div>
</div>
<div class="section level3">
<h3 id="results-phase-3-no-phase-2-conducted">Results Phase 3, No Phase 2 Conducted<a class="anchor" aria-label="anchor" href="#results-phase-3-no-phase-2-conducted"></a>
</h3>
<p>For Phase 3, the unconditional probability of a Go decision is 29%
and the unconditional probability of a No-Go Decision is 71%. The 95%
posterior credible for the Log( True HR ) is
(-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>,
0.12 ). The posterior distribution of the true Log( HR ) given a Go
decision is:</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="results-phase-3-conditional-on-phase-2-go-decision">Results Phase 3, Conditional on Phase 2 Go Decision<a class="anchor" aria-label="anchor" href="#results-phase-3-conditional-on-phase-2-go-decision"></a>
</h3>
<p>For Phase 3, conditional on the phase 2 making a go decision, the
probability of a Go decision is 60% and the unconditional probability of
a No-Go Decision is 40%. The 95% posterior credible for the Log( True HR
) is (-0.46, -0.08). The posterior distribution of the true Log( HR )
given a Phase 3 Go decision is:</p>
<p><img src="AssuranceConsecutiveStudies_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="section level4">
<h4 id="de-risking-1">De-risking<a class="anchor" aria-label="anchor" href="#de-risking-1"></a>
</h4>
<p>Comparing the option of running only a Phase 3 versus a Phase 2
followed by a Phase 3 if Phase 2 is successful, the probability of Go in
phase 3 increases from 29% to 60% and the probability of a No-Go in
Phase 3 decreases from 71% to 40%.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by J. Kyle Wathen, Valeria A. G. Mazzanti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
